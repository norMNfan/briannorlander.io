!function(e){"use strict";function i(e){return this.id="viewer-"+Math.round(Math.random()*Math.pow(10,6)).toString(),this.viewerOpen=!1,this.figure=e,this.scrim=document.getElementsByClassName("scrim")[0],this.lastWindowWidth=window.innerWidth,this.transitionEndEvent=function(){var e,i=document.createElement("fakeelement"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",MSTransition:"msTransitionEnd",OTransition:"otransitionend",transition:"transitionend"};for(e in t)if(t.hasOwnProperty(e)&&void 0!==i.style[e])return t[e]}(),this.forceSmall=0<=this.figure.className.indexOf("force-small"),this.forceMedium=0<=this.figure.className.indexOf("force-medium"),this.forceLarge=0<=this.figure.className.indexOf("force-large"),window.addEventListener("keyup",function(e){27===e.keyCode&&this.closeViewer()}.bind(this)),this.load(),0<=this.figure.className.indexOf("with-viewer")&&this.figure.addEventListener("click",this.openViewer.bind(this)),this}i.prototype.closeViewer=function(){window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onShouldCloseViewer),window.removeEventListener("orientationchange",this.onShouldCloseViewer),this.scrim.removeEventListener("click",this.onShouldCloseViewer),this.figure.addEventListener(this.transitionEndEvent,function(){-1==document.body.className.indexOf(this.id)&&(this.viewerOpen=!1,this.figure.className=this.figure.className.replace("is-open","").replace(/^\s+|\s+$/g,""),this.figure.style.zIndex="")}.bind(this)),document.body.className=document.body.className.replace(this.id,"").replace(/^\s+|\s+$/g,""),this.figure.style.transform=""},i.prototype.openViewer=function(){var e,i,t,s,n,o,r,a;0<=document.body.className.indexOf(this.id)?this.closeViewer():(this.viewerOpen=!0,n=window.getComputedStyle(this.figure),e=parseFloat(n.height),i=parseFloat(n.width),t=window.innerHeight,s=window.innerWidth,n=this.figure.getBoundingClientRect(),i/e<=s/t?(r=(s-i*(o=t/e))/2-n.left,a=-1*n.top):(a=(t-e*(o=s/i))/2-n.top,r=-1*n.left),document.body.className+=" "+this.id,this.figure.className+=" is-open",this.figure.style.zIndex="800",this.figure.style.transform="translate3d("+r+"px,"+a+"px,0) scale("+o+")",setTimeout(function(){this.figure.className.indexOf("loaded-raw")<=0&&this.loadRaw()}.bind(this),300),this.onScroll=function(){var e=this.figure.getBoundingClientRect().top;50<Math.abs(e)&&this.closeViewer()}.bind(this),this.onShouldCloseViewer=function(e){this.closeViewer(),e.stopPropagation()}.bind(this),this.scrim.addEventListener("click",this.onShouldCloseViewer),window.addEventListener("resize",this.onShouldCloseViewer),window.addEventListener("orientationchange",this.onShouldCloseViewer),window.addEventListener("scroll",this.onScroll))},i.prototype.load=function(){var e=new Image;e.src=this.figure.dataset[this.getSize()],e.className="full",e.onload=function(){this.figure.className+=" loaded"}.bind(this),this.figure.appendChild(e)},i.prototype.loadRaw=function(){var e=new Image;e.src=this.figure.dataset.raw,e.className="raw",e.onload=function(){this.figure.className+=" loaded-raw"}.bind(this),this.figure.appendChild(e)},i.prototype.getSize=function(){if(this.forceSmall)return"small";if(this.forceMedium)return"medium";if(this.forceLarge)return"large";var e=this.lastWindowWidth<768?0:this.lastWindowWidth<1440?1:2;return 1<window.devicePixelRatio&&e<2&&(e+=1),["small","medium","large"][e]},"function"==typeof define&&define.amd?define(i):"undefined"!=typeof module&&module.exports?module.exports=i:e.ProgressiveImage=i}(this);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvZ3Jlc3NpdmUtaW1hZ2UuanMiLCJzb3VyY2VzIjpbInByb2dyZXNzaXZlLWltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKipcbiAgICogRmluZCB0aGUgQ1NTIHRyYW5zaXRpb24gZW5kIGV2ZW50IHRoYXQgd2Ugc2hvdWxkIGxpc3RlbiBmb3IuXG4gICAqXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9IHQgLSB0aGUgdHJhbnNpdGlvbiBzdHJpbmdcbiAgICovXG4gIGZ1bmN0aW9uIF93aGljaFRyYW5zaXRpb25FbmRFdmVudCgpIHtcbiAgICB2YXIgdDtcbiAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmYWtlZWxlbWVudCcpO1xuICAgIHZhciB0cmFuc2l0aW9ucyA9IHtcbiAgICAgIFdlYmtpdFRyYW5zaXRpb246ICd3ZWJraXRUcmFuc2l0aW9uRW5kJyxcbiAgICAgIE1velRyYW5zaXRpb246ICd0cmFuc2l0aW9uZW5kJyxcbiAgICAgIE1TVHJhbnNpdGlvbjogJ21zVHJhbnNpdGlvbkVuZCcsXG4gICAgICBPVHJhbnNpdGlvbjogJ290cmFuc2l0aW9uZW5kJyxcbiAgICAgIHRyYW5zaXRpb246ICd0cmFuc2l0aW9uZW5kJyxcbiAgICB9O1xuICAgIGZvciAodCBpbiB0cmFuc2l0aW9ucykge1xuICAgICAgaWYgKHRyYW5zaXRpb25zLmhhc093blByb3BlcnR5KHQpKSB7XG4gICAgICAgIGlmIChlbC5zdHlsZVt0XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgcmV0dXJuIHRyYW5zaXRpb25zW3RdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgY2xhc3MgbWFuYWdlcyBhIHNpbmdsZSBpbWFnZS4gSXQga2VlcHMgdHJhY2sgb2YgdGhlIGltYWdlJ3MgaGVpZ2h0LFxuICAgKiB3aWR0aCwgYW5kIHBvc2l0aW9uIGluIHRoZSBncmlkLiBBbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzIGlzIGFzc29jaWF0ZWRcbiAgICogd2l0aCBhIHNpbmdsZSBpbWFnZSBmaWd1cmUsIHdoaWNoIGxvb2tzIGxpa2UgdGhpczpcbiAgICpcbiAgICogICA8ZmlndXJlIGNsYXNzPVwicHJvZ3Jlc3NpdmUtaW1hZ2VcIlxuICAgKiAgICAgICBkYXRhLXNtYWxsPVwiLi4uXCJcbiAgICogICAgICAgZGF0YS1tZWRpdW09XCIuLi5cIlxuICAgKiAgICAgICBkYXRhLWxhcmdlPVwiLi4uXCJcbiAgICogICAgICAgZGF0YS1yYXc9XCIuLi5cIj5cbiAgICogICAgIDxkaXYgY2xhc3M9XCJhc3BlY3QtcmF0aW8taG9sZGVyXCIgc3R5bGU9XCJwYWRkaW5nLWJvdHRvbTogLi4uXCI+PC9kaXY+XG4gICAqICAgICA8aW1nIGNsYXNzPVwidGh1bWJuYWlsXCIgc3JjPVwiLi4uXCIgYWx0PVwiLi4uXCI+XG4gICAqICAgPC9maWd1cmU+XG4gICAqXG4gICAqIEBwYXJhbSB7ZWxlbWVudH0gZmlndXJlIC0gdGhlIDxmaWd1cmU+IERPTSBlbGVtZW50LlxuICAgKiBAcmV0dXJucyB7b2JqZWN0fSB0aGUgcHJvZ3Jlc3NpdmUgaW1hZ2Ugb2JqZWN0XG4gICAqL1xuICBmdW5jdGlvbiBQcm9ncmVzc2l2ZUltYWdlKGZpZ3VyZSkge1xuICAgIHRoaXMuaWQgPSBcInZpZXdlci1cIiArIE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSpNYXRoLnBvdygxMCw2KSkudG9TdHJpbmcoKTtcbiAgICB0aGlzLnZpZXdlck9wZW4gPSBmYWxzZTtcbiAgICB0aGlzLmZpZ3VyZSA9IGZpZ3VyZTtcbiAgICB0aGlzLnNjcmltID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc2NyaW0nKVswXTtcbiAgICB0aGlzLmxhc3RXaW5kb3dXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICAgIHRoaXMudHJhbnNpdGlvbkVuZEV2ZW50ID0gX3doaWNoVHJhbnNpdGlvbkVuZEV2ZW50KCk7XG4gICAgdGhpcy5mb3JjZVNtYWxsID0gKHRoaXMuZmlndXJlLmNsYXNzTmFtZS5pbmRleE9mKCdmb3JjZS1zbWFsbCcpID49IDApO1xuICAgIHRoaXMuZm9yY2VNZWRpdW0gPSAodGhpcy5maWd1cmUuY2xhc3NOYW1lLmluZGV4T2YoJ2ZvcmNlLW1lZGl1bScpID49IDApO1xuICAgIHRoaXMuZm9yY2VMYXJnZSA9ICh0aGlzLmZpZ3VyZS5jbGFzc05hbWUuaW5kZXhPZignZm9yY2UtbGFyZ2UnKSA+PSAwKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihlKSB7XG4gICAgICBpZiAoZS5rZXlDb2RlID09PSAyNyAvKiBFU0MgKi8pIHtcbiAgICAgICAgdGhpcy5jbG9zZVZpZXdlcigpO1xuICAgICAgfVxuICAgIH0uYmluZCh0aGlzKSk7XG4gICAgdGhpcy5sb2FkKCk7XG5cbiAgICBpZiAodGhpcy5maWd1cmUuY2xhc3NOYW1lLmluZGV4T2YoJ3dpdGgtdmlld2VyJykgPj0gMCkge1xuICAgICAgdGhpcy5maWd1cmUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9wZW5WaWV3ZXIuYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBQcm9ncmVzc2l2ZUltYWdlLnByb3RvdHlwZS5jbG9zZVZpZXdlciA9IGZ1bmN0aW9uICgpIHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5vblNjcm9sbCk7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMub25TaG91bGRDbG9zZVZpZXdlcik7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29yaWVudGF0aW9uY2hhbmdlJywgdGhpcy5vblNob3VsZENsb3NlVmlld2VyKTtcbiAgICB0aGlzLnNjcmltLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vblNob3VsZENsb3NlVmlld2VyKTtcblxuICAgIHRoaXMuZmlndXJlLmFkZEV2ZW50TGlzdGVuZXIodGhpcy50cmFuc2l0aW9uRW5kRXZlbnQsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChkb2N1bWVudC5ib2R5LmNsYXNzTmFtZS5pbmRleE9mKHRoaXMuaWQpID09IC0xKSB7XG4gICAgICAgIHRoaXMudmlld2VyT3BlbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLmZpZ3VyZS5jbGFzc05hbWUgPSB0aGlzLmZpZ3VyZS5jbGFzc05hbWVcbiAgICAgICAgICAucmVwbGFjZSgnaXMtb3BlbicsICcnKVxuICAgICAgICAgIC5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJyk7XG4gICAgICAgIHRoaXMuZmlndXJlLnN0eWxlLnpJbmRleCA9ICcnO1xuICAgICAgfVxuICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAvLyBCZWdpbiB0cmFuc2l0aW9uXG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc05hbWUgPSBkb2N1bWVudC5ib2R5LmNsYXNzTmFtZVxuICAgICAgLnJlcGxhY2UodGhpcy5pZCwgJycpXG4gICAgICAucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgJycpO1xuICAgIHRoaXMuZmlndXJlLnN0eWxlLnRyYW5zZm9ybSA9ICcnO1xuICB9O1xuXG4gIFByb2dyZXNzaXZlSW1hZ2UucHJvdG90eXBlLm9wZW5WaWV3ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGRvY3VtZW50LmJvZHkuY2xhc3NOYW1lLmluZGV4T2YodGhpcy5pZCkgPj0gMCkge1xuICAgICAgdGhpcy5jbG9zZVZpZXdlcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudmlld2VyT3BlbiA9IHRydWU7XG5cbiAgICAvLyBJbml0aWFsIFZhbHVlc1xuICAgIHZhciBmaWd1cmVTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZmlndXJlKTtcbiAgICB2YXIgaW5pdGlhbEhlaWdodCA9IHBhcnNlRmxvYXQoZmlndXJlU3R5bGUuaGVpZ2h0KTtcbiAgICB2YXIgaW5pdGlhbFdpZHRoID0gcGFyc2VGbG9hdChmaWd1cmVTdHlsZS53aWR0aCk7XG4gICAgdmFyIHdpbmRvd0hlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcbiAgICB2YXIgd2luZG93V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICB2YXIgZmlndXJlQm91bmRpbmdSZWN0ID0gdGhpcy5maWd1cmUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAvLyBDb21wdXRlZCBWYWx1ZXNcbiAgICB2YXIgZmlndXJlQXNwZWN0UmF0aW8gPSBpbml0aWFsV2lkdGggLyBpbml0aWFsSGVpZ2h0O1xuICAgIHZhciB3aW5kb3dBc3BlY3RSYXRpbyA9IHdpbmRvd1dpZHRoIC8gd2luZG93SGVpZ2h0O1xuICAgIHZhciBzY2FsZTtcbiAgICB2YXIgdHJhbnNsYXRlWDtcbiAgICB2YXIgdHJhbnNsYXRlWTtcblxuICAgIGlmICh3aW5kb3dBc3BlY3RSYXRpbyA+PSBmaWd1cmVBc3BlY3RSYXRpbykge1xuICAgICAgLy8gSW1hZ2Ugd2lsbCBmaWxsIHVwIHZlcnRpY2FsIHNwYWNlXG4gICAgICBzY2FsZSA9IHdpbmRvd0hlaWdodCAvIGluaXRpYWxIZWlnaHQ7XG4gICAgICB2YXIgZmluYWxXaWR0aCA9IGluaXRpYWxXaWR0aCAqIHNjYWxlO1xuICAgICAgdHJhbnNsYXRlWCA9ICh3aW5kb3dXaWR0aCAtIGZpbmFsV2lkdGgpIC8gMiAtIGZpZ3VyZUJvdW5kaW5nUmVjdC5sZWZ0O1xuICAgICAgdHJhbnNsYXRlWSA9IGZpZ3VyZUJvdW5kaW5nUmVjdC50b3AgKiAtMTtcblxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJbWFnZSB3aWxsIGZpbGwgdXAgaG9yaXpvbnRhbCBzcGFjZVxuICAgICAgc2NhbGUgPSB3aW5kb3dXaWR0aCAvIGluaXRpYWxXaWR0aDtcbiAgICAgIHZhciBmaW5hbEhlaWdodCA9IGluaXRpYWxIZWlnaHQgKiBzY2FsZTtcbiAgICAgIHRyYW5zbGF0ZVkgPSAod2luZG93SGVpZ2h0IC0gZmluYWxIZWlnaHQpIC8gMiAtIGZpZ3VyZUJvdW5kaW5nUmVjdC50b3A7XG4gICAgICB0cmFuc2xhdGVYID0gZmlndXJlQm91bmRpbmdSZWN0LmxlZnQgKiAtMTtcbiAgICB9XG5cbiAgICAvLyBBcHBseSBET00gdHJhbnNmb3JtYXRpb25zXG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc05hbWUgKz0gJyAnICsgdGhpcy5pZDtcbiAgICB0aGlzLmZpZ3VyZS5jbGFzc05hbWUgKz0gJyBpcy1vcGVuJztcbiAgICB0aGlzLmZpZ3VyZS5zdHlsZS56SW5kZXggPSAnODAwJztcbiAgICB0aGlzLmZpZ3VyZS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoJyArIHRyYW5zbGF0ZVggKyAncHgsJyArXG4gICAgICB0cmFuc2xhdGVZICsgJ3B4LDApIHNjYWxlKCcgKyBzY2FsZSArICcpJztcblxuICAgIC8vIExvYWQgUmF3IEltYWdlIChsYXJnZSEpXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5maWd1cmUuY2xhc3NOYW1lLmluZGV4T2YoJ2xvYWRlZC1yYXcnKSA8PSAwKSB7XG4gICAgICAgIC8vIFRoZXJlIGlzIGEgbGFyZ2VyIGltYWdlIHRvIGxvYWQuXG4gICAgICAgIHRoaXMubG9hZFJhdygpO1xuICAgICAgfVxuICAgIH0uYmluZCh0aGlzKSwgMzAwKTtcblxuICAgIHRoaXMub25TY3JvbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgb2Zmc2V0ID0gdGhpcy5maWd1cmUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuICAgICAgaWYgKE1hdGguYWJzKG9mZnNldCkgPiA1MCkge1xuICAgICAgICB0aGlzLmNsb3NlVmlld2VyKCk7XG4gICAgICB9XG4gICAgfS5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5vblNob3VsZENsb3NlVmlld2VyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuY2xvc2VWaWV3ZXIoKTtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgfS5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5zY3JpbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25TaG91bGRDbG9zZVZpZXdlcik7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMub25TaG91bGRDbG9zZVZpZXdlcik7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ29yaWVudGF0aW9uY2hhbmdlJywgdGhpcy5vblNob3VsZENsb3NlVmlld2VyKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5vblNjcm9sbCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIExvYWQgdGhlIGZ1bGwgaW1hZ2UgZWxlbWVudCBpbnRvIHRoZSBET00uXG4gICAqL1xuICBQcm9ncmVzc2l2ZUltYWdlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIENyZWF0ZSBhIG5ldyBpbWFnZSBlbGVtZW50LCBhbmQgaW5zZXJ0IGl0IGludG8gdGhlIERPTS5cbiAgICB2YXIgZnVsbEltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgZnVsbEltYWdlLnNyYyA9IHRoaXMuZmlndXJlLmRhdGFzZXRbdGhpcy5nZXRTaXplKCldO1xuICAgIGZ1bGxJbWFnZS5jbGFzc05hbWUgPSAnZnVsbCc7XG4gICAgZnVsbEltYWdlLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuZmlndXJlLmNsYXNzTmFtZSArPSAnIGxvYWRlZCc7XG4gICAgfS5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5maWd1cmUuYXBwZW5kQ2hpbGQoZnVsbEltYWdlKTtcbiAgfTtcblxuICAvKipcbiAgICogTG9hZCB0aGUgcmF3IGltYWdlIGVsZW1lbnQgaW50byB0aGUgRE9NLlxuICAgKi9cbiAgUHJvZ3Jlc3NpdmVJbWFnZS5wcm90b3R5cGUubG9hZFJhdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBDcmVhdGUgYSBuZXcgaW1hZ2UgZWxlbWVudCwgYW5kIGluc2VydCBpdCBpbnRvIHRoZSBET00uXG4gICAgdmFyIHJhd0ltYWdlID0gbmV3IEltYWdlKCk7XG5cbiAgICAvLyBub3QgYWN0dWFsbHkgcmF3LCBiZWNhdXNlIGRhbW4sIHRoYXQncyBleHBlbnNpdmUuXG4gICAgcmF3SW1hZ2Uuc3JjID0gdGhpcy5maWd1cmUuZGF0YXNldC5yYXc7XG4gICAgcmF3SW1hZ2UuY2xhc3NOYW1lID0gJ3Jhdyc7XG4gICAgcmF3SW1hZ2Uub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5maWd1cmUuY2xhc3NOYW1lICs9ICcgbG9hZGVkLXJhdyc7XG4gICAgfS5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5maWd1cmUuYXBwZW5kQ2hpbGQocmF3SW1hZ2UpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDaG9vc2UgdGhlIHNpemUgb2YgaW1hZ2UgdG8gbG9hZCBiYXNlZCBvbiB0aGUgd2luZG93IHdpZHRoLlxuICAgKi9cbiAgUHJvZ3Jlc3NpdmVJbWFnZS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5mb3JjZVNtYWxsKSB7XG4gICAgICByZXR1cm4gJ3NtYWxsJztcbiAgICB9IGVsc2UgaWYgKHRoaXMuZm9yY2VNZWRpdW0pIHtcbiAgICAgIHJldHVybiAnbWVkaXVtJztcbiAgICB9IGVsc2UgaWYgKHRoaXMuZm9yY2VMYXJnZSkge1xuICAgICAgcmV0dXJuICdsYXJnZSc7XG4gICAgfVxuXG4gICAgdmFyIHNpemVzID0gWydzbWFsbCcsICdtZWRpdW0nLCAnbGFyZ2UnXTtcbiAgICB2YXIgc2l6ZUluZGV4O1xuICAgIGlmICh0aGlzLmxhc3RXaW5kb3dXaWR0aCA8IDc2OCkge1xuICAgICAgc2l6ZUluZGV4ID0gMDsgLy8gc21hbGxcbiAgICB9IGVsc2UgaWYgKHRoaXMubGFzdFdpbmRvd1dpZHRoIDwgMTQ0MCkge1xuICAgICAgc2l6ZUluZGV4ID0gMTsgLy8gbWVkaXVtXG4gICAgfSBlbHNlIHtcbiAgICAgIHNpemVJbmRleCA9IDI7IC8vIGxhcmdlO1xuICAgIH1cblxuICAgIC8vIFJldGluYSBkZXZpY2VzIHNob3VsZCBoYXZlIGxhcmdlciBwaXhlbCBkZW5zaXRpZXMuXG4gICAgaWYgKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvID4gMSAmJiBzaXplSW5kZXggPCAyKSB7XG4gICAgICBzaXplSW5kZXggKz0gMTtcbiAgICB9XG5cbiAgICByZXR1cm4gc2l6ZXNbc2l6ZUluZGV4XTtcbiAgfTtcblxuICAvLyBFeHBvcnQgUHJvZ3Jlc3NpdmVJbWFnZSBpbnRvIHRoZSBnbG9iYWwgc2NvcGUuXG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoUHJvZ3Jlc3NpdmVJbWFnZSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IFByb2dyZXNzaXZlSW1hZ2U7XG4gIH0gZWxzZSB7XG4gICAgZ2xvYmFsLlByb2dyZXNzaXZlSW1hZ2UgPSBQcm9ncmVzc2l2ZUltYWdlO1xuICB9XG5cbn0odGhpcykpO1xuIl0sIm5hbWVzIjpbImdsb2JhbCIsIlByb2dyZXNzaXZlSW1hZ2UiLCJmaWd1cmUiLCJ0aGlzIiwiaWQiLCJNYXRoIiwicm91bmQiLCJyYW5kb20iLCJwb3ciLCJ0b1N0cmluZyIsInZpZXdlck9wZW4iLCJzY3JpbSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImxhc3RXaW5kb3dXaWR0aCIsIndpbmRvdyIsImlubmVyV2lkdGgiLCJ0cmFuc2l0aW9uRW5kRXZlbnQiLCJ0IiwiZWwiLCJjcmVhdGVFbGVtZW50IiwidHJhbnNpdGlvbnMiLCJXZWJraXRUcmFuc2l0aW9uIiwiTW96VHJhbnNpdGlvbiIsIk1TVHJhbnNpdGlvbiIsIk9UcmFuc2l0aW9uIiwidHJhbnNpdGlvbiIsImhhc093blByb3BlcnR5IiwidW5kZWZpbmVkIiwic3R5bGUiLCJfd2hpY2hUcmFuc2l0aW9uRW5kRXZlbnQiLCJmb3JjZVNtYWxsIiwiY2xhc3NOYW1lIiwiaW5kZXhPZiIsImZvcmNlTWVkaXVtIiwiZm9yY2VMYXJnZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwia2V5Q29kZSIsImNsb3NlVmlld2VyIiwiYmluZCIsImxvYWQiLCJvcGVuVmlld2VyIiwicHJvdG90eXBlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm9uU2Nyb2xsIiwib25TaG91bGRDbG9zZVZpZXdlciIsImJvZHkiLCJyZXBsYWNlIiwiekluZGV4IiwidHJhbnNmb3JtIiwiaW5pdGlhbEhlaWdodCIsImluaXRpYWxXaWR0aCIsIndpbmRvd0hlaWdodCIsIndpbmRvd1dpZHRoIiwiZmlndXJlQm91bmRpbmdSZWN0Iiwic2NhbGUiLCJ0cmFuc2xhdGVYIiwidHJhbnNsYXRlWSIsImZpZ3VyZVN0eWxlIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsInBhcnNlRmxvYXQiLCJoZWlnaHQiLCJ3aWR0aCIsImlubmVySGVpZ2h0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwibGVmdCIsInRvcCIsInNldFRpbWVvdXQiLCJsb2FkUmF3Iiwib2Zmc2V0IiwiYWJzIiwic3RvcFByb3BhZ2F0aW9uIiwiZnVsbEltYWdlIiwiSW1hZ2UiLCJzcmMiLCJkYXRhc2V0IiwiZ2V0U2l6ZSIsIm9ubG9hZCIsImFwcGVuZENoaWxkIiwicmF3SW1hZ2UiLCJyYXciLCJzaXplSW5kZXgiLCJkZXZpY2VQaXhlbFJhdGlvIiwiZGVmaW5lIiwiYW1kIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkNBQUMsU0FBVUEsZ0JBNENULFNBQVNDLEVBQWlCQyxHQXFCeEIsT0FwQkFDLEtBQUtDLEdBQUssVUFBWUMsS0FBS0MsTUFBTUQsS0FBS0UsU0FBU0YsS0FBS0csSUFBSSxHQUFHLElB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
